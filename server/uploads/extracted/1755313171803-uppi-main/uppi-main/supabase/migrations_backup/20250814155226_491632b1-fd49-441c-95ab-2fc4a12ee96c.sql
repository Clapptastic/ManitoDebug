-- Fix remaining Function Search Path Security Issues
-- Set search_path for all remaining functions that don't have it

ALTER FUNCTION public.handle_updated_at() SET search_path = public;
ALTER FUNCTION public.is_super_admin(text) SET search_path = public;
ALTER FUNCTION public.update_user_provider_costs_updated_at() SET search_path = public;
ALTER FUNCTION public.log_performance_metric(text, integer, uuid, text, text, jsonb) SET search_path = public;
ALTER FUNCTION public.track_realtime_subscription(uuid, text, text, text, jsonb) SET search_path = public;
ALTER FUNCTION public.update_prompt_flow_counters() SET search_path = public;
ALTER FUNCTION public.upsert_company_profile(uuid, text, text, jsonb) SET search_path = public;
ALTER FUNCTION public.link_analysis_to_company(uuid, uuid, uuid) SET search_path = public;
ALTER FUNCTION public.get_tables(text) SET search_path = public;
ALTER FUNCTION public.update_prompt_flow_updated_at() SET search_path = public;
ALTER FUNCTION public.verify_backup_integrity() SET search_path = public;
ALTER FUNCTION public.get_prompt_flow_status(uuid) SET search_path = public;
ALTER FUNCTION public.encrypt_sensitive_data(text) SET search_path = public;
ALTER FUNCTION public.decrypt_sensitive_data(bytea) SET search_path = public;
ALTER FUNCTION public.get_prompts_with_flow_status() SET search_path = public;
ALTER FUNCTION public.hash_api_key(text) SET search_path = public;
ALTER FUNCTION public.anonymize_user_data(uuid) SET search_path = public;
ALTER FUNCTION public.log_sensitive_access(text, text, text) SET search_path = public;
ALTER FUNCTION public.check_api_key_status(text) SET search_path = public;
ALTER FUNCTION public.log_security_event_enhanced(uuid, text, text, text, jsonb, inet, text) SET search_path = public;
ALTER FUNCTION public.cleanup_old_audit_logs() SET search_path = public;
ALTER FUNCTION public.run_security_scan() SET search_path = public;
ALTER FUNCTION public.get_system_health_safe() SET search_path = public;
ALTER FUNCTION public.assign_prompt_to_flow(uuid, uuid, boolean, integer) SET search_path = public;
ALTER FUNCTION public.get_flow_health_metrics() SET search_path = public;
ALTER FUNCTION public.validate_api_key_data() SET search_path = public;
ALTER FUNCTION public.cleanup_old_flow_test_runs() SET search_path = public;
ALTER FUNCTION public.cleanup_old_analysis_runs() SET search_path = public;
ALTER FUNCTION public.log_sensitive_data_access() SET search_path = public;
ALTER FUNCTION public.validate_user_api_key(text, boolean) SET search_path = public;
ALTER FUNCTION public.safe_uuid_cast(text) SET search_path = public;
ALTER FUNCTION public.match_code_embeddings(extensions.vector, double precision, integer, uuid) SET search_path = public;
ALTER FUNCTION public.monitor_database_performance() SET search_path = public;
ALTER FUNCTION public.get_system_health_overview() SET search_path = public;
ALTER FUNCTION public.check_rate_limit(uuid, text, integer) SET search_path = public;
ALTER FUNCTION public.insert_master_profile_contribution(text, text, jsonb, numeric) SET search_path = public;
ALTER FUNCTION public.touch_updated_at() SET search_path = public;
ALTER FUNCTION public.is_admin_user(uuid) SET search_path = public;
ALTER FUNCTION public.can_access_api_key(uuid, uuid) SET search_path = public;
ALTER FUNCTION public.log_security_event(uuid, text, text, text, jsonb) SET search_path = public;
ALTER FUNCTION public.get_user_api_keys_safe(uuid) SET search_path = public;
ALTER FUNCTION public.get_user_api_key_for_validation(text) SET search_path = public;
ALTER FUNCTION public.update_api_key_status(text, text, text) SET search_path = public;
ALTER FUNCTION public.log_application_error(text, text, jsonb, uuid) SET search_path = public;
ALTER FUNCTION public.get_system_health() SET search_path = public;
ALTER FUNCTION public.cleanup_old_sessions() SET search_path = public;
ALTER FUNCTION public.handle_new_user() SET search_path = public;
ALTER FUNCTION public.handle_profile_update() SET search_path = public;
ALTER FUNCTION public.reset_user_password(text) SET search_path = public;
ALTER FUNCTION public.exec_sql(text) SET search_path = public;
ALTER FUNCTION public.log_api_key_access() SET search_path = public;
ALTER FUNCTION public.get_effective_feature_flag(text, uuid) SET search_path = public;
ALTER FUNCTION public.set_prompt_version() SET search_path = public;
ALTER FUNCTION public.increment_helpful_count(uuid) SET search_path = public;
ALTER FUNCTION public.increment_not_helpful_count(uuid) SET search_path = public;
ALTER FUNCTION public.start_transaction_log(uuid, text, integer, jsonb) SET search_path = public;
ALTER FUNCTION public.check_organization_permission(uuid, uuid, text) SET search_path = public;